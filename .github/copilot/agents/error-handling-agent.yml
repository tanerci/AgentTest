name: error-handling-agent
description: >
  Enforces consistent error handling patterns using the Result<T> pattern
  for expected failures, proper HTTP status codes, and a global exception
  handler for unhandled errors.
pillar: reliability
tags: [reliability, error, exceptions, result-pattern, http-status]
version: "2.0"
tasks:
  - type: validate-error-handling
    inputs:
      source: "**/*.cs"
      ruleset: ".github/copilot/rules/error-handling.json"
      checks:
        - "result-pattern-usage"
        - "exception-types"
        - "error-responses"
        - "http-status-codes"
  - type: detect-issues
    inputs:
      patterns:
        - "empty-catch-blocks"
        - "generic-exceptions"
        - "swallowed-exceptions"
        - "missing-error-messages"
  - type: generate-middleware
    inputs:
      framework: "ASP.NET Core"
      output: "Middleware/GlobalExceptionHandler.cs"
      features:
        - "exception-logging"
        - "problem-details"
        - "error-tracking"
        - "trace-id"
  - type: suggest-improvements
    inputs:
      recommendations:
        - "use-result-pattern"
        - "map-domain-errors-to-http"
        - "validation-errors"
